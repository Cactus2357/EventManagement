@page
@using System.Security.Claims
@using EventManagement.Helpers
@model EventManagement.Pages.Users.DetailsModel

@{
    ViewData["Title"] = "Details";
}

@* <h1>Details</h1> *@

<div class="container pt-4 px-5">
    @* <h4>User</h4> *@
    @* <hr /> *@
    @* <dl class="row">
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.User.Name)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.User.Name)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.User.Email)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.User.Email)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.User.Role)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.User.Role)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.User.CreatedAt)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.User.CreatedAt)
        </dd>
    </dl> *@
    <div class="mb-3">
        @if (User.Identity.IsAuthenticated)
        {
            string userRole = User.FindFirst(ClaimTypes.Role)?.Value;
            string color = userRole switch
            {
                "admin" => "danger",
                "organizer" => "primary",
                "attendee" => "success",
                _ => "secondary",
            };

            <h3>
                @Model.User.Name
            </h3>
            <div>
                User Role:
                <span class="badge bg-@color">@userRole</span>
            </div>
            <p>Created At: @Model.User.CreatedAt</p>
        }

        <a href="#">@Model.User.Email</a>
        <div>
            <a asp-page="./Edit" asp-route-id="@Model.User.UserId">Edit Details</a>
            @if (base.User.IsAdmin())
            {
                Write("| ");
                <a asp-page="./Index">Back to List</a>
            }
        </div>
    </div>
    <hr />
    <div>
        <h4>Registered Events</h4>
        <ul>
            @foreach (var e in Model.Events)
            {
                <li><a asp-page="/Events/Details" asp-route-id="@e.EventId">@e.Title</a></li>
            }
        </ul>
    </div>
</div>
